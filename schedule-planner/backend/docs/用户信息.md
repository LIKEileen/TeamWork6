<!-- Author: å”éœ‡ -->

## ç”¨æˆ·ä¿¡æ¯ API æ¥å£ 

### **æ›´æ–°ç”¨æˆ·ä¿¡æ¯**

**æ¥å£åç§°ï¼š**`/api/user/update`

**åŠŸèƒ½**ï¼šæ›´æ–°å½“å‰ç™»å½•ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼ŒåŒ…æ‹¬æ˜µç§°ã€æ‰‹æœºå·ã€é‚®ç®±ç­‰ã€‚

**è¯·æ±‚å‚æ•°**ï¼š

| å­—æ®µ     | è¯´æ˜           | ç±»å‹   | å¤‡æ³¨                         | æ˜¯å¦å¿…å¡« |
| -------- | -------------- | ------ | ---------------------------- | -------- |
| nickname | ç”¨æˆ·æ˜µç§°       | string | ç”¨æˆ·çš„æ˜µç§°                   | æ˜¯       |
| phone    | ç”¨æˆ·æ‰‹æœºå·     | string | ç”¨æˆ·çš„æ‰‹æœºå·                 | å¦       |
| email    | ç”¨æˆ·é‚®ç®±       | string | ç”¨æˆ·çš„é‚®ç®±                   | å¦       |
| token    | ç”¨æˆ·èº«ä»½ token | string | å½“å‰ç™»å½•ç”¨æˆ·çš„èº«ä»½éªŒè¯ token | æ˜¯       |

> **æ³¨æ„**ï¼š
>
> - `nickname` ä¸ºå¿…å¡«å­—æ®µï¼Œè¯¥å­—æ®µä¸èƒ½ä¸ºç©ºã€‚
> - `phone` å’Œ `email` æ˜¯å¯é€‰çš„ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰ä¿®æ”¹ï¼Œåå°å¯ä»¥å¿½ç•¥ã€‚

**è¿”å›å‚æ•°**ï¼š

| å­—æ®µ    | è¯´æ˜         | ç±»å‹   | å¤‡æ³¨                          | æ˜¯å¦å¿…å¡« |
| ------- | ------------ | ------ | ----------------------------- | -------- |
| code    | æ¥å£çŠ¶æ€ç    | number | æˆåŠŸï¼š1ï¼Œå¤±è´¥ï¼š0              | æ˜¯       |
| message | æ¥å£è¿”å›ä¿¡æ¯ | string | æˆåŠŸï¼šsuccessï¼Œå¤±è´¥ï¼šé”™è¯¯ä¿¡æ¯ | æ˜¯       |
| data    | ç”¨æˆ·ä¿¡æ¯     | object | åŒ…å«ç”¨æˆ·çš„æœ€æ–°ä¿¡æ¯            | å¦       |

**data** å­—æ®µï¼ˆè¿”å›çš„ç”¨æˆ·ä¿¡æ¯ï¼‰ï¼š

| å­—æ®µ     | è¯´æ˜       | ç±»å‹   | å¤‡æ³¨                | æ˜¯å¦å¿…å¡« |
| -------- | ---------- | ------ | ------------------- | -------- |
| nickname | ç”¨æˆ·æ˜µç§°   | string | æ›´æ–°åçš„æ˜µç§°        | æ˜¯       |
| phone    | ç”¨æˆ·æ‰‹æœºå· | string | æ›´æ–°åçš„æ‰‹æœºå·      | å¦       |
| email    | ç”¨æˆ·é‚®ç®±   | string | æ›´æ–°åçš„é‚®ç®±        | å¦       |
| avatar   | ç”¨æˆ·å¤´åƒ   | string | ç”¨æˆ·å¤´åƒçš„ URL åœ°å€ | å¦       |

**ç¤ºä¾‹è¯·æ±‚**ï¼š

```http
POST /api/user/update
```

è¯·æ±‚ä½“ï¼š

```json
{
  "nickname": "å¼ ä¸‰",
  "phone": "13812345678",
  "email": "zhangsan@example.com",
  "token": "mock-token-abc123"
}
```

**å“åº”**ï¼š

```json
{
  "code": 1,
  "message": "ç”¨æˆ·ä¿¡æ¯å·²æ›´æ–°",
  "data": {
    "nickname": "å¼ ä¸‰",
    "phone": "13812345678",
    "email": "zhangsan@example.com",
    "avatar": "/assets/default_icon.jpg"
  }
}
```

**è¯´æ˜**ï¼š

1. **`token`**ï¼šç”¨äºéªŒè¯å½“å‰ç”¨æˆ·èº«ä»½ã€‚åªæœ‰é€šè¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·æ‰èƒ½æ›´æ–°å…¶ä¿¡æ¯ã€‚
2. **`code`**ï¼šæ¥å£è¿”å›çš„çŠ¶æ€ç ï¼Œ`1` è¡¨ç¤ºæˆåŠŸï¼Œ`0` è¡¨ç¤ºå¤±è´¥ã€‚
3. **`message`**ï¼šæ¥å£è¿”å›çš„æç¤ºä¿¡æ¯ï¼ŒæˆåŠŸæ—¶ä¸º `"ç”¨æˆ·ä¿¡æ¯å·²æ›´æ–°"`ï¼Œå¤±è´¥æ—¶ä¸ºå…·ä½“é”™è¯¯ä¿¡æ¯ã€‚
4. **`data`**ï¼šåŒ…å«æ›´æ–°åçš„ç”¨æˆ·ä¿¡æ¯ï¼ŒåŒ…æ‹¬ `nickname`ã€`phone`ã€`email` å’Œ `avatar`ï¼ˆå¤´åƒ URLï¼‰ã€‚



### **ä¿®æ”¹å¯†ç **

**è¯·æ±‚æ¥å£**ï¼š`/api/user/change-password`

**åŠŸèƒ½**ï¼šç”¨äºä¿®æ”¹ç”¨æˆ·å¯†ç ï¼Œæ¥å—åŸå¯†ç å’Œæ–°å¯†ç ï¼ŒæˆåŠŸåè¿”å›ä¿®æ”¹ç»“æœã€‚

**è¯·æ±‚å‚æ•°**ï¼š

| å­—æ®µ        | è¯´æ˜           | ç±»å‹   | å¤‡æ³¨                         | æ˜¯å¦å¿…å¡« |
| ----------- | -------------- | ------ | ---------------------------- | -------- |
| oldPassword | åŸå¯†ç          | string | ç”¨æˆ·å½“å‰å¯†ç                  | æ˜¯       |
| newPassword | æ–°å¯†ç          | string | ç”¨æˆ·æƒ³è¦ä¿®æ”¹çš„æ–°å¯†ç          | æ˜¯       |
| token       | ç”¨æˆ·èº«ä»½ token | string | å½“å‰ç™»å½•ç”¨æˆ·çš„èº«ä»½éªŒè¯ token | æ˜¯       |

**è¿”å›å‚æ•°**ï¼š

| å­—æ®µ    | è¯´æ˜         | ç±»å‹   | å¤‡æ³¨                          | æ˜¯å¦å¿…å¡« |
| ------- | ------------ | ------ | ----------------------------- | -------- |
| code    | æ¥å£çŠ¶æ€ç    | number | æˆåŠŸï¼š1ï¼Œå¤±è´¥ï¼š0              | æ˜¯       |
| message | æ¥å£è¿”å›ä¿¡æ¯ | string | æˆåŠŸï¼šsuccessï¼Œå¤±è´¥ï¼šé”™è¯¯ä¿¡æ¯ | æ˜¯       |

**ç¤ºä¾‹è¯·æ±‚**ï¼š

```http
POST /api/user/change-password
```

è¯·æ±‚ä½“ï¼š

```json
{
  "oldPassword": "123456",
  "newPassword": "newpassword123",
  "token": "mock-token-abc123"
}
```

**ç¤ºä¾‹å“åº”**ï¼š

```json
{
  "code": 1,
  "message": "å¯†ç ä¿®æ”¹æˆåŠŸ"
}
```


æˆ‘å°†æ ¹æ®æ¥å£æ–‡æ¡£ä¸ºä½ æä¾›å®Œæ•´çš„Postmanæµ‹è¯•æµç¨‹å’Œè¾“å…¥æ•°æ®ã€‚

## ğŸ§ª Postman æµ‹è¯•æµç¨‹

### ç¬¬ä¸€æ­¥ï¼šç”¨æˆ·æ³¨å†Œ

**POST** `http://127.0.0.1:5000/api/register`

**Headers:**
```
Content-Type: application/json
```

**Body (raw JSON):**
```json
{
  "nickname": "æµ‹è¯•ç”¨æˆ·å¼ ä¸‰",
  "phone": "13812345678", 
  "email": "zhangsan@example.com",
  "password": "123456"
}
```

**é¢„æœŸå“åº”:**
```json
{
  "code": 1,
  "message": "success",
  "data": {
    "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
    "nickname": "æµ‹è¯•ç”¨æˆ·å¼ ä¸‰",
    "avatar": "/assets/default_icon.jpg",
    "email": "zhangsan@example.com", 
    "phone": "13812345678",
    "role": "user"
  }
}
```

---

### ç¬¬äºŒæ­¥ï¼šç”¨æˆ·ç™»å½•ï¼ˆè·å–tokenï¼‰

**POST** `http://127.0.0.1:5000/api/login`

**Headers:**
```
Content-Type: application/json
```

**Body (raw JSON) - é‚®ç®±ç™»å½•:**
```json
{
  "email": "zhangsan@example.com",
  "password": "123456"
}
```

**æˆ–è€…æ‰‹æœºå·ç™»å½•:**
```json
{
  "phone": "13812345678",
  "password": "123456"
}
```

**é¢„æœŸå“åº”:**
```json
{
  "code": 1,
  "message": "success",
  "data": {
    "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
    "nickname": "æµ‹è¯•ç”¨æˆ·å¼ ä¸‰",
    "avatar": "/assets/default_icon.jpg",
    "email": "zhangsan@example.com",
    "phone": "13812345678", 
    "role": "user"
  }
}
```

**âš ï¸ é‡è¦ï¼šå¤åˆ¶å“åº”ä¸­çš„ `token` å€¼ï¼Œåç»­æµ‹è¯•éœ€è¦ä½¿ç”¨**

---

### ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•æ›´æ–°ç”¨æˆ·ä¿¡æ¯

**POST** `http://127.0.0.1:5000/api/user/update`

**Headers:**
```
Content-Type: application/json
```

**Body (raw JSON):**
```json
{
  "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
  "nickname": "å¼ ä¸‰-å·²æ›´æ–°",
  "phone": "13987654321",
  "email": "zhangsan_new@example.com"
}
```

**é¢„æœŸå“åº”:**
```json
{
  "code": 1,
  "message": "ç”¨æˆ·ä¿¡æ¯å·²æ›´æ–°",
  "data": {
    "nickname": "å¼ ä¸‰-å·²æ›´æ–°",
    "phone": "13987654321", 
    "email": "zhangsan_new@example.com",
    "avatar": "/assets/default_icon.jpg"
  }
}
```

---

### ç¬¬å››æ­¥ï¼šæµ‹è¯•ä¿®æ”¹å¯†ç 

**POST** `http://127.0.0.1:5000/api/user/change-password`

**Headers:**
```
Content-Type: application/json
```

**Body (raw JSON):**
```json
{
  "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
  "oldPassword": "123456",
  "newPassword": "newpassword123"
}
```

**é¢„æœŸå“åº”:**
```json
{
  "code": 1,
  "message": "å¯†ç ä¿®æ”¹æˆåŠŸ"
}
```

---

### ç¬¬äº”æ­¥ï¼šéªŒè¯æ–°å¯†ç ç™»å½•

**POST** `http://127.0.0.1:5000/api/login`

**Headers:**
```
Content-Type: application/json
```

**Body (raw JSON):**
```json
{
  "email": "zhangsan_new@example.com",
  "password": "newpassword123"
}
```

**é¢„æœŸå“åº”:**
```json
{
  "code": 1,
  "message": "success",
  "data": {
    "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
    "nickname": "å¼ ä¸‰-å·²æ›´æ–°",
    "avatar": "/assets/default_icon.jpg",
    "email": "zhangsan_new@example.com",
    "phone": "13987654321",
    "role": "user"
  }
}
```

---

### ç¬¬å…­æ­¥ï¼šæµ‹è¯•é€€å‡ºç™»å½•

**POST** `http://127.0.0.1:5000/api/logout`

**Headers:**
```
Content-Type: application/json
```

**Body (raw JSON):**
```json
{
  "token": "ä½ çš„å®é™…token"
}
```

**é¢„æœŸå“åº”:**
```json
{
  "code": 1,
  "message": "é€€å‡ºæˆåŠŸ"
}
```

---

## ğŸ” é¢å¤–æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯•è¾¹ç•Œæƒ…å†µ 1ï¼šåªæ›´æ–°æ˜µç§°

**POST** `http://127.0.0.1:5000/api/user/update`

```json
{
  "token": "ä½ çš„token",
  "nickname": "ä»…æ›´æ–°æ˜µç§°"
}
```

### æµ‹è¯•è¾¹ç•Œæƒ…å†µ 2ï¼šé”™è¯¯çš„åŸå¯†ç 

**POST** `http://127.0.0.1:5000/api/user/change-password`

```json
{
  "token": "ä½ çš„token", 
  "oldPassword": "é”™è¯¯å¯†ç ",
  "newPassword": "newpassword456"
}
```

**é¢„æœŸå“åº”:**
```json
{
  "code": 0,
  "message": "åŸå¯†ç é”™è¯¯"
}
```

### æµ‹è¯•è¾¹ç•Œæƒ…å†µ 3ï¼šæ— æ•ˆtoken

**POST** `http://127.0.0.1:5000/api/user/update`

```json
{
  "token": "invalid-token",
  "nickname": "æµ‹è¯•æ˜µç§°"
}
```

**é¢„æœŸå“åº”:**
```json
{
  "code": 0,
  "message": "ç”¨æˆ·æœªç™»å½•æˆ– token æ— æ•ˆ"
}
```

### æµ‹è¯•è¾¹ç•Œæƒ…å†µ 4ï¼šé‡å¤é‚®ç®±

å…ˆæ³¨å†Œå¦ä¸€ä¸ªç”¨æˆ·ï¼Œç„¶åå°è¯•æ›´æ–°ä¸ºå·²å­˜åœ¨çš„é‚®ç®±ï¼š

**POST** `http://127.0.0.1:5000/api/user/update`

```json
{
  "token": "ä½ çš„token",
  "nickname": "æµ‹è¯•ç”¨æˆ·",
  "email": "å·²å­˜åœ¨çš„é‚®ç®±@example.com"
}
```

**é¢„æœŸå“åº”:**
```json
{
  "code": 0,
  "message": "è¯¥é‚®ç®±å·²è¢«å…¶ä»–ç”¨æˆ·ä½¿ç”¨"
}
```

---

## ğŸ“ æµ‹è¯•æ­¥éª¤è¯´æ˜

1. **æŒ‰é¡ºåºæ‰§è¡Œ**ï¼šå¿…é¡»å…ˆæ³¨å†Œâ†’ç™»å½•â†’è·å–tokenâ†’æµ‹è¯•ç”¨æˆ·ä¿¡æ¯æ¥å£
2. **ä¿å­˜token**ï¼šä»ç™»å½•å“åº”ä¸­å¤åˆ¶tokenï¼Œæ›¿æ¢åç»­è¯·æ±‚ä¸­çš„tokenå€¼
3. **æ£€æŸ¥å“åº”**ï¼šç¡®è®¤æ¯ä¸ªè¯·æ±‚çš„å“åº”ç å’Œæ¶ˆæ¯ç¬¦åˆé¢„æœŸ
4. **éªŒè¯æ•°æ®æŒä¹…åŒ–**ï¼šæ›´æ–°ä¿¡æ¯åé€šè¿‡é‡æ–°ç™»å½•éªŒè¯æ•°æ®æ˜¯å¦æ­£ç¡®ä¿å­˜

## âš ï¸ æ³¨æ„äº‹é¡¹

- è¯·å°†ç¤ºä¾‹ä¸­çš„ `token` æ›¿æ¢ä¸ºå®é™…ç™»å½•åè·å¾—çš„tokenå€¼
- ç¡®ä¿åç«¯æœåŠ¡å·²å¯åŠ¨åœ¨ `http://127.0.0.1:5000`
- æ ¹æ®æ¥å£æ–‡æ¡£ï¼Œç”¨æˆ·ä¿¡æ¯æ›´æ–°æ¥å£ä¸­`nickname`æ˜¯å¿…å¡«å­—æ®µ
- æ‰‹æœºå·å’Œé‚®ç®±æ ¼å¼éœ€è¦ç¬¦åˆåç«¯éªŒè¯è§„åˆ™ï¼ˆæ‰‹æœºå·ï¼š11ä½æ•°å­—ï¼Œé‚®ç®±ï¼šæ ‡å‡†é‚®ç®±æ ¼å¼ï¼‰
- å¯†ç é•¿åº¦è‡³å°‘6ä½
- å¦‚æœé‡åˆ°CORSé”™è¯¯ï¼Œè¯·ç¡®è®¤åç«¯å·²é…ç½®CORSæ”¯æŒ

## ğŸ“Š é¢„æœŸæµ‹è¯•ç»“æœ

å®Œæˆæ‰€æœ‰æµ‹è¯•åï¼Œä½ åº”è¯¥èƒ½å¤ŸéªŒè¯ï¼š
1. âœ… ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½æ­£å¸¸
2. âœ… ç”¨æˆ·ç™»å½•åŠŸèƒ½æ­£å¸¸ï¼ˆé‚®ç®±å’Œæ‰‹æœºå·éƒ½æ”¯æŒï¼‰
3. âœ… ç”¨æˆ·ä¿¡æ¯æ›´æ–°åŠŸèƒ½æ­£å¸¸
4. âœ… å¯†ç ä¿®æ”¹åŠŸèƒ½æ­£å¸¸
5. âœ… æ–°å¯†ç ç™»å½•åŠŸèƒ½æ­£å¸¸
6. âœ… é€€å‡ºç™»å½•åŠŸèƒ½æ­£å¸¸
7. âœ… é”™è¯¯å¤„ç†æœºåˆ¶å·¥ä½œæ­£å¸¸