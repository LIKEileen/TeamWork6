schedule-planner/
├── backend/
│   ├── app/
│   │   ├── __pycache__/
│   │   ├── models/
│   │   │   ├── __pycache__/
│   │   │   └── user.py
│   │   ├── routes/
│   │   │   ├── __pycache__/
│   │   │   ├── auth.py
│   │   │   ├── meeting.py
│   │   │   ├── schedule.py
│   │   │   └── upload.py
│   │   ├── services/
│   │   │   ├── auth_service.py
│   │   │   ├── meeting_service.py
│   │   │   ├── schedule_service.py
│   │   │   ├── upload_service.py
│   │   │   └── verification.py
│   │   ├── __init__.py
│   │   └── config.py
│   └── requirements.txt
├── run.py
└── README.md


如何用 Postman 测试登录页的接口：

## 1. 启动你的 Flask 应用

首先确保你的应用能正常运行：

```powershell
cd E:\kaiyuan\TeamWork6\schedule-planner\backend
python run.py
```

如果看到类似输出说明启动成功：
```
* Running on all addresses (0.0.0.0)
* Running on http://127.0.0.1:5000
* Running on http://[::]:5000
```

## 2. 在 Postman 中测试各个接口

### 测试1：用户登录 `/api/login`

**请求设置：**
- **Method**: `POST`
- **URL**: `http://127.0.0.1:5000/api/login`
- **Headers**: 
  - `Content-Type`: `application/json`
- **Body** (选择 raw + JSON):

```json
{
    "phone": "19121221904",
    "password": "123456"
}
```

或者用邮箱登录：
```json
{
    "email": "1628980622@qq.com", 
    "password": "123456"
}
```

**预期响应：**
```json
{
    "code": 1,
    "message": "登录成功",
    "data": {
        "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
        "nickname": "张三",
        "avatar": "https://imgheybox.max-c.com/bbs/2024/09/19/...",
        "email": "1628980622@qq.com",
        "phone": "19121221904",
        "role": "admin"
    }
}
```

### 测试2：用户注册 `/api/register`

**请求设置：**
- **Method**: `POST`
- **URL**: `http://127.0.0.1:5000/api/register`
- **Headers**: 
  - `Content-Type`: `application/json`
- **Body** (raw + JSON):

```json
{
    "nickname": "测试用户",
    "phone": "13888888888",
    "email": "test@example.com",
    "password": "password123"
}
```

### 测试3：发送验证码 `/api/send-verification-code`

**请求设置：**
- **Method**: `POST`
- **URL**: `http://127.0.0.1:5000/api/send-verification-code`
- **Headers**: 
  - `Content-Type`: `application/json`
- **Body** (raw + JSON):

```json
{
    "email": "1628980622@qq.com"
}
```

### 测试4：重置密码 `/api/reset-password`

**请求设置：**
- **Method**: `POST`
- **URL**: `http://127.0.0.1:5000/api/reset-password`
- **Headers**: 
  - `Content-Type`: `application/json`
- **Body** (raw + JSON):

```json
{
    "email": "1628980622@qq.com",
    "code": "123456",
    "password": "newpassword123"
}
```

### 测试5：绑定手机号 `/api/bind`

**请求设置：**
- **Method**: `POST`
- **URL**: `http://127.0.0.1:5000/api/bind`
- **Headers**: 
  - `Content-Type`: `application/json`
- **Body** (raw + JSON):

```json
{
    "nickname": "张三",
    "password": "123456",
    "phone": "13999999999"
}
```

### 测试6：退出登录 `/api/logout`

**请求设置：**
- **Method**: `POST`
- **URL**: `http://127.0.0.1:5000/api/logout`
- **Headers**: 
  - `Content-Type`: `application/json`
- **Body** (raw + JSON):

```json
{
    "token": "这里填写从登录接口获取的token"
}
```

## 3. 测试步骤建议

1. **先测试登录** - 使用预设的用户（张三/19121221904/123456）
2. **测试注册** - 创建新用户
3. **测试发送验证码** - 需要配置邮箱服务器才能实际发送
4. **测试绑定手机号** - 使用已有用户绑定新手机号
5. **测试退出登录** - 使用登录获取的token

## 4. 可能遇到的问题及解决

### 如果遇到邮件发送失败：
需要在 `config.py` 中配置真实的邮箱信息：

````python
EMAIL_CONFIG = {
    'smtp_server': 'smtp.qq.com',
    'smtp_port': 587,
    'sender_email': '你的QQ邮箱@qq.com',
    'sender_password': '你的QQ邮箱授权码',  # 不是QQ密码！
    'sender_name': 'Schedule Planner'
}
````

### 如果遇到CORS错误：
确保 `flask-cors` 已安装并在 __init__.py 中正确配置。


eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU


根据你的项目结构和提供的token，我来给出完整的日程相关接口测试用例：

## 测试日程相关接口

### 前提条件
- 确保Flask应用已启动：`http://127.0.0.1:5000`
- 使用你提供的有效token：`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU`

---

## 1. 获取用户日程

**接口：** `/api/user/schedule`

**请求设置：**
- **Method**: `POST`
- **URL**: `http://127.0.0.1:5000/api/user/schedule`
- **Headers**: `Content-Type: application/json`
- **Body**:

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU"
}
```

**预期响应：**
```json
{
  "code": 1,
  "message": "success",
  "data": []
}
```

---

## 2. 添加单个日程事件

**接口：** `/api/user/schedule/add`

**请求设置：**
- **Method**: `POST`
- **URL**: `http://127.0.0.1:5000/api/user/schedule/add`
- **Headers**: `Content-Type: application/json`
- **Body**:

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU",
  "title": "数学课",
  "date": "2025-01-26",
  "start": "08:00",
  "end": "09:30",
  "color": "#F56C6C"
}
```

**预期响应：**
```json
{
  "code": 1,
  "message": "创建成功",
  "data": {
    "id": 1,
    "title": "数学课",
    "day": "2025-01-26",
    "start": "08:00",
    "end": "09:30",
    "color": "#F56C6C"
  }
}
```

---

## 3. 测试时间冲突检测

**添加第二个事件（时间冲突）：**

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU",
  "title": "物理课",
  "date": "2025-01-26",
  "start": "08:30",
  "end": "10:00",
  "color": "#67C23A"
}
```

**预期响应（冲突）：**
```json
{
  "code": 0,
  "message": "时间冲突：与以下事件重叠 - 《数学课》(08:00-09:30)",
  "data": {}
}
```

---

## 4. 强制创建冲突事件

**使用 `forceCreate` 参数：**

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU",
  "title": "物理课",
  "date": "2025-01-26",
  "start": "08:30",
  "end": "10:00",
  "color": "#67C23A",
  "forceCreate": true
}
```

**预期响应（成功创建）：**
```json
{
  "code": 1,
  "message": "创建成功",
  "data": {
    "id": 2,
    "title": "物理课",
    "day": "2025-01-26",
    "start": "08:30",
    "end": "10:00",
    "color": "#67C23A"
  }
}
```

---

## 5. 添加重复事件（每日）

**接口：** `/api/user/schedule/add/recurring`

**请求设置：**
- **Method**: `POST`
- **URL**: `http://127.0.0.1:5000/api/user/schedule/add/recurring`
- **Body**:

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU",
  "title": "晨跑",
  "start": "06:30",
  "end": "07:30",
  "frequency": "daily",
  "repeatCount": 7,
  "color": "#67C23A"
}
```

**预期响应：**
```json
{
  "code": 1,
  "message": "成功创建7个重复事件"
}
```

---

## 6. 添加重复事件（每周）

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU",
  "title": "英语课",
  "start": "14:00",
  "end": "15:30",
  "frequency": "weekly",
  "repeatCount": 4,
  "color": "#409EFF"
}
```

---

## 7. 添加自定义重复事件

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU",
  "title": "期末考试",
  "start": "09:00",
  "end": "11:00",
  "frequency": "custom",
  "customDates": ["2025-06-15", "2025-06-17", "2025-06-19"],
  "color": "#E6A23C"
}
```

---

## 8. 检查时间冲突

**接口：** `/api/user/schedule/check-conflict`

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU",
  "date": "2025-01-26",
  "start": "08:15",
  "end": "09:45"
}
```

**预期响应：**
```json
{
  "code": 1,
  "message": "检查完成",
  "data": {
    "hasConflict": true,
    "conflicts": [
      {
        "id": 1,
        "title": "数学课",
        "start_time": "08:00",
        "end_time": "09:30"
      },
      {
        "id": 2,
        "title": "物理课",
        "start_time": "08:30",
        "end_time": "10:00"
      }
    ]
  }
}
```

---

## 9. 删除日程事件

**接口：** `/api/user/schedule/delete`

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU",
  "eventId": 1
}
```

**预期响应：**
```json
{
  "code": 1,
  "message": "删除成功"
}
```

---

## 10. 再次获取日程验证结果

**最后再调用获取日程接口，验证所有操作：**

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjUxNDcsImlhdCI6MTc0ODE3ODc0Nywicm9sZSI6ImFkbWluIn0.fuIXKrNMJiWPeCt3OgSbM4i6AJ3R9NaKCqk-jBU82dU"
}
```

---

## 测试顺序建议

1. **获取空日程列表** → 确认初始状态
2. **添加单个事件** → 测试基本功能
3. **尝试添加冲突事件** → 测试冲突检测
4. **强制添加冲突事件** → 测试强制创建
5. **添加重复事件** → 测试重复功能
6. **检查冲突** → 测试冲突检查接口
7. **删除事件** → 测试删除功能
8. **最终验证** → 确认所有操作结果


根据你提供的新token和接口文档，我来重写头像相关API接口的测试方法：

## 头像相关API测试用例

### 新token信息
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjgyOTMsImlhdCI6iTc0ODE4MTg5Mywicm9sZSI6ImFkbWluIn0.DYpvWllXRbBki9WnFSJkG4o4IwE4s1c1SajSGCNFbGw
```

---

## 1. 上传头像接口测试

### 📋 接口信息
- **URL**: `http://127.0.0.1:5000/api/user/avatar/upload`
- **Method**: `POST`
- **Content-Type**: `multipart/form-data`

### 🧪 Postman测试步骤

1. **选择请求方式**: `POST`
2. **输入URL**: `http://127.0.0.1:5000/api/user/avatar/upload`
3. **设置Body**:
   - 选择 `form-data`
   - 添加字段：

| Key | Type | Value |
|-----|------|-------|
| token | Text | `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjgyOTMsImlhdCI6MTc0ODE4MTg5Mywicm9sZSI6ImFkbWluIn0.DYpvWllXRbBki9WnFSJkG4o4IwE4s1c1SajSGCNFbGw` |
| avatar | File | [选择图片文件：jpg/png/gif/webp] |

### ✅ 预期成功响应
```json
{
  "code": 1,
  "message": "头像上传成功",
  "avatarUrl": "/uploads/avatars/avatar_1_xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.jpg"
}
```

### ❌ 预期失败响应

**未选择文件：**
```json
{
  "code": 0,
  "message": "没有选择文件"
}
```

**文件格式不支持：**
```json
{
  "code": 0,
  "message": "不支持的文件格式，请上传 PNG、JPG、JPEG、GIF 或 WEBP 格式的图片"
}
```

**文件过大（>5MB）：**
```json
{
  "code": 0,
  "message": "文件大小不能超过5MB"
}
```

---

## 2. 获取用户资料接口测试

### 📋 接口信息
- **URL**: `http://127.0.0.1:5000/api/user/profile`
- **Method**: `POST`
- **Content-Type**: `application/json`

### 🧪 Postman测试步骤

1. **选择请求方式**: `POST`
2. **输入URL**: `http://127.0.0.1:5000/api/user/profile`
3. **设置Headers**:
   ```
   Content-Type: application/json
   ```
4. **设置Body** (选择 `raw` → `JSON`):
   ```json
   {
     "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjgyOTMsImlhdCI6iTc0ODE4MTg5Mywicm9sZSI6ImFkbWluIn0.DYpvWllXRbBki9WnFSJkG4o4IwE4s1c1SajSGCNFbGw"
   }
   ```

### ✅ 预期成功响应
```json
{
  "code": 1,
  "message": "获取成功",
  "data": {
    "nickname": "用户昵称",
    "phone": "13888888888",
    "email": "user@example.com",
    "avatar": "/uploads/avatars/avatar_1_xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.jpg",
    "role": "admin"
  }
}
```

---

## 3. 更新用户信息接口测试

### 📋 接口信息
- **URL**: `http://127.0.0.1:5000/api/user/update`
- **Method**: `POST`
- **Content-Type**: `application/json`

### 🧪 Postman测试步骤

1. **选择请求方式**: `POST`
2. **输入URL**: `http://127.0.0.1:5000/api/user/update`
3. **设置Headers**:
   ```
   Content-Type: application/json
   ```
4. **设置Body** (选择 `raw` → `JSON`):
   ```json
   {
     "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNzMyNDIsImlhdCI6MTc0ODE4Njg0Miwicm9sZSI6InVzZXIifQ.Py15akRYs7Bgh8qj2JIHrp83lM_xUl0Wjve8Wk2SYaU",
     "nickname": "新昵称",
     "phone": "13999999999",
     "email": "newemail@example.com"
   }
   ```

### ✅ 预期成功响应
```json
{
  "code": 1,
  "message": "用户信息已更新",
  "data": {
    "nickname": "新昵称",
    "phone": "13999999999",
    "email": "newemail@example.com",
    "avatar": "/uploads/avatars/avatar_1_xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.jpg"
  }
}
```

---

## 4. 修改密码接口测试

### 📋 接口信息
- **URL**: `http://127.0.0.1:5000/api/user/change-password`
- **Method**: `POST`
- **Content-Type**: `application/json`

### 🧪 Postman测试步骤

1. **选择请求方式**: `POST`
2. **输入URL**: `http://127.0.0.1:5000/api/user/change-password`
3. **设置Headers**:
   ```
   Content-Type: application/json
   ```
4. **设置Body** (选择 `raw` → `JSON`):
   ```json
   {
     "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NDgyNjgyOTMsImlhdCI6iTc0ODE4MTg5Mywicm9sZSI6ImFkbWluIn0.DYpvWllXRbBki9WnFSJkG4o4IwE4s1c1SajSGCNFbGw",
     "oldPassword": "123456",
     "newPassword": "newpassword123"
   }
   ```

### ✅ 预期成功响应
```json
{
  "code": 1,
  "message": "密码修改成功"
}
```

### ❌ 预期失败响应
```json
{
  "code": 0,
  "message": "原密码错误"
}
```

---

## 5. 验证头像访问测试

### 📋 测试说明
上传头像成功后，应该可以通过返回的URL直接访问头像文件。

### 🧪 测试步骤

1. **先执行上传头像接口**，获取返回的 `avatarUrl`
2. **在浏览器中访问头像URL**:
   ```
   http://127.0.0.1:5000/uploads/avatars/avatar_1_xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.jpg
   ```
3. **验证结果**: 应该能正常显示上传的头像图片

---

## 6. 完整测试流程

### 🔄 建议测试顺序

1. **获取当前用户资料** → 查看初始状态
2. **上传新头像** → 测试文件上传功能
3. **更新用户信息** → 测试信息修改功能
4. **再次获取用户资料** → 验证更新结果
5. **访问头像URL** → 验证文件访问
6. **修改密码** → 测试密码修改功能

### 📝 测试检查清单

- [ ] 上传头像成功并返回正确URL
- [ ] 头像文件可以通过URL正常访问
- [ ] 更新用户信息后头像URL保持不变
- [ ] 获取用户资料接口返回最新的头像URL
- [ ] 各种错误情况（文件格式、大小、token无效等）处理正确
- [ ] 密码修改功能正常工作

---

## 7. 故障排除

### 🚨 常见问题

1. **头像上传后无法访问**
   - 检查 `uploads/avatars` 目录是否存在
   - 确认Flask应用配置了静态文件服务

2. **Token无效错误**
   - 检查token是否复制完整
   - 确认token没有过期

3. **文件上传失败**
   - 检查文件大小是否超过5MB
   - 确认文件格式是否支持












